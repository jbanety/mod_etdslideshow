function jInsertEditorText(t,e){var a=new Element("span").set("html",t),i=a.getChildren()[0].getAttribute("src");$(e).value=i,addthumbnail(i,e)}function addthumbnail(t,e){var a=$(e).getParent().getElement("img"),i="http";-1!=t.toLowerCase().indexOf(i.toLowerCase())?a.src=t:a.src=JURI+t,a.setProperty("width","64px"),a.setProperty("height","64px")}function addslideetd(t,e,a,i,s,n,d,o,l,r,c,p){t||(t=""),e||(e=""),e=e.replace(/\|dq\|/g,"&quot;"),a||(a=""),a=a.replace(/\|dq\|/g,"&quot;"),i||(i=""),i=i.replace(/\|dq\|/g,"&quot;"),n||(n=""),d&&"default"!=d?"_parent"==d?imgtargetoption='<option value="default">'+Joomla.JText._("MOD_ETDSLIDESHOW_DEFAULT","default")+'</option><option value="_parent" selected="selected">'+Joomla.JText._("MOD_ETDSLIDESHOW_SAMEWINDOW","same window")+'</option><option value="_blank">'+Joomla.JText._("MOD_ETDSLIDESHOW_NEWWINDOW","new window")+"</option>":"lightbox"==d?imgtargetoption='<option value="default">'+Joomla.JText._("MOD_ETDSLIDESHOW_DEFAULT","default")+'</option><option value="_parent">'+Joomla.JText._("MOD_ETDSLIDESHOW_SAMEWINDOW","same window")+'</option><option value="_blank">'+Joomla.JText._("MOD_ETDSLIDESHOW_NEWWINDOW","new window")+"</option>":imgtargetoption='<option value="default">'+Joomla.JText._("MOD_ETDSLIDESHOW_DEFAULT","default")+'</option><option value="_parent">'+Joomla.JText._("MOD_ETDSLIDESHOW_SAMEWINDOW","same window")+'</option><option value="_blank" selected="selected">'+Joomla.JText._("MOD_ETDSLIDESHOW_NEWWINDOW","new window")+"</option>":(d="",imgtargetoption='<option value="default" selected="selected">'+Joomla.JText._("MOD_ETDSLIDESHOW_DEFAULT","default")+'</option><option value="_parent">'+Joomla.JText._("MOD_ETDSLIDESHOW_SAMEWINDOW","same window")+'</option><option value="_blank">'+Joomla.JText._("MOD_ETDSLIDESHOW_NEWWINDOW","new window")+'</option><option value="lightbox">'+Joomla.JText._("MOD_ETDSLIDESHOW_LIGHTBOX","in a Lightbox")+"</option>"),index=checkIndex(0);var u=new Element("li",{"class":"etdslide",id:"etdslide"+index});u.set("html",'<div class="etdslidehandle"><div class="etdslidenumber">'+index+'</div></div><div class="etdslidecontainer"><input name="etdslidedelete'+index+'" class="etdslidedelete" type="button" value="'+Joomla.JText._("MOD_ETDSLIDESHOW_REMOVE2","")+'" onclick="javascript:removeslide(this.getParent().getParent());" /><div class="etdsliderow"><div class="etdslideimgcontainer"><img src="'+s+'" width="64" height="64"/></div><input name="etdslideimgname'+index+'" id="etdslideimgname'+index+'" class="etdslideimgname hasTip" title="Image::This is the main image for the slide, it will also be used to create the thumbnail" type="text" value="'+t+'" onchange="javascript:addthumbnail(this.value, this);" /><a class="modal ckselectimg" href="index.php?option=com_media&view=images&tmpl=component&e_name=etdslideimgname'+index+'" rel="{handler: \'iframe\', size: {x: 570, y: 400}}" >'+Joomla.JText._("MOD_ETDSLIDESHOW_SELECTIMAGE","select image")+'</a></div></div><div class="etdsliderow"><span class="etdslidelabel">'+Joomla.JText._("MOD_ETDSLIDESHOW_CAPTIONTXT","Caption Text")+'</span><input name="etdslidecaptiontext'+index+'" class="etdslidecaptiontext" type="text" value="'+e+'" onchange="javascript:storesetwarning();" /></div><div class="etdsliderow"><span class="etdslidelabel">'+Joomla.JText._("MOD_ETDSLIDESHOW_CAPTIONAUTHOR","Caption Author")+'</span><input name="etdslidecaptionauthor'+index+'" class="etdslidecaptionauthor" type="text" value="'+a+'" onchange="javascript:storesetwarning();" /></div><div class="etdsliderow"><span class="etdslidelabel">'+Joomla.JText._("MOD_ETDSLIDESHOW_CAPTIONPOSITION","Caption position")+'</span><input name="etdslidecaptionposition'+index+'" class="etdslidecaptionposition" type="text" value="'+i+'" onchange="javascript:storesetwarning();" /></div><div class="etdsliderow"><div id="etdslideaccordion'+index+'"><span class="etdslideaccordeonbutton">'+Joomla.JText._("MOD_ETDSLIDESHOW_LINKOPTIONS","Link options")+'</span><div style="clear:both;"></div><div class="etdslideaccordeoncontent"><div class="etdsliderow"><span class="etdslidelabel">'+Joomla.JText._("MOD_ETDSLIDESHOW_LINK","Link url")+'</span><input name="etdslidelinktext'+index+'" class="etdslidelinktext" type="text" value="'+n+'" onchange="javascript:storesetwarning();" /></div><div class="etdsliderow"><span class="etdslidelabel">'+Joomla.JText._("MOD_ETDSLIDESHOW_TARGET","Target")+'</span><select name="etdslidetargettext'+index+'" class="etdslidetargettext" >'+imgtargetoption+'</select></div></div></div></div></div><div style="clear:both;"></div>'),document.id("etdslideslist").adopt(u),storeslideetd(),makesortables(),SqueezeBox.initialize({}),SqueezeBox.assign(u.getElement("a.modal"),{parse:"rel"}),new Fx.Accordion($("accordion"+index),"#etdslideaccordion"+index+" .etdslideaccordeonbutton","#etdslideaccordion"+index+" .etdslideaccordeoncontent",{onActive:function(t,e){t.addClass("open")},onBackground:function(t,e){t.removeClass("open")}})}function checkIndex(t){for(;$("etdslide"+t);)t++;return t}function removeslide(t){confirm(Joomla.JText._("MOD_ETDSLIDESHOW_REMOVE","Remove this slide")+" ?")&&(t.destroy(),storeslideetd())}function storesetwarning(){}function storeremovewarning(){}function storeslideetd(){var t=0,e=new Array;document.id("etdslideslist").getElements(".etdslide").each(function(a){slide=new Object,slide.imgname=a.getElement(".etdslideimgname").value,slide.imgcaptiontxt=a.getElement(".etdslidecaptiontext").value,slide.imgcaptiontxt=slide.imgcaptiontxt.replace(/"/g,"|dq|"),slide.imgcaptionauthor=a.getElement(".etdslidecaptionauthor").value,slide.imgcaptionauthor=slide.imgcaptionauthor.replace(/"/g,"|dq|"),slide.imgcaptionposition=a.getElement(".etdslidecaptionposition").value,slide.imgcaptionposition=slide.imgcaptionposition.replace(/"/g,"|dq|"),slide.imgthumb=a.getElement("img").src,slide.imglink=a.getElement(".etdslidelinktext").value,slide.imglink=slide.imglink.replace(/"/g,"|dq|"),slide.imgtarget=a.getElement(".etdslidetargettext").value,e[t]=slide,t++}),e=JSON.encode(e),e=e.replace(/"/g,"|qq|"),document.id("etdslides").value=e,storeremovewarning()}function callslides(){var t=JSON.decode(document.id("etdslides").value.replace(/\|qq\|/g,'"'));t&&(t.each(function(t){addslideetd(t.imgname,t.imgcaptiontxt,t.imgcaptionauthor,t.imgcaptionposition,t.imgthumb,t.imglink,t.imgtarget)}),storeremovewarning())}function makesortables(){new Sortables("etdslideslist",{clone:!0,revert:!0,handle:".etdslidehandle",initialize:function(){},onStart:function(t){t.setStyle("background","#add8e6")},onComplete:function(t){t.setStyle("background","#fff"),storesetwarning()},onSort:function(t,e){}})}window.addEvent("domready",function(){callslides();var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.text="Joomla.submitbutton = function(task){storeslideetd();if (task == 'module.cancel' || document.formvalidator.isValid(document.id('module-form'))) {	Joomla.submitform(task, document.getElementById('module-form'));if (self != top) {window.top.setTimeout('window.parent.SqueezeBox.close()', 1000);}} else {alert('Formulaire invalide');}}",document.body.appendChild(t)});
